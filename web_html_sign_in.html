<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <title>Login Box</title>

<!-- Link to css -->
  <link rel="stylesheet" href="web_css_sign_in.css">
</head>
<body>

    <div class="login-box">
      <h2>Sign In</h2>
      <!--  Regular sign/log in -->
      <form action="/login" method="post">
        <input type="text" name="username" placeholder="Username" required>
        <input type="password" name="password" placeholder="Password" required>
        <button type="submit">Sign In</button>
      </form>

      <!-- Sign in button -->
      <div id="google-signin-button"></div>
    </div>

    <!-- Google library -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <!-- callback setting -->
    <script>
      function handleCredentialResponse(response) {
        fetch('/gcallback', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ credential: response.credential })
        })
        .then(r => r.json())
        .then(data => {
          if (data.success) {
            window.location.href = '/dashboard';  // או כל דף אחר
          } else {
            alert('Login failed');
          }
        });
      }

      window.onload = () => {
        google.accounts.id.initialize({
          client_id: '182999458483-8nv6bv428s0pl8c2a34thvp4qat5ovdh.apps.googleusercontent.com',
          callback: handleCredentialResponse
        });
        google.accounts.id.renderButton(
          document.getElementById('google-signin-button'),
          { theme: 'outline', size: 'large', text: 'signin_with' }
        );
      };
    </script>

</body>
</html>
